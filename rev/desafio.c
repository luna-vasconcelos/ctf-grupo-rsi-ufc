#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include "sbox_header.h"
uint8_t obfuscated[64] = {
0x1C,0x26,0x31,0x0D,0x11,0x00,0x23,0x0E,
0x2D,0x10,0x21,0x1D,0x25,0x19,0x1A,0x0C,
0x35,0x18,0x3A,0x2C,0x2A,0x29,0x38,0x3F,
0x01,0x27,0x22,0x0B,0x2B,0x17,0x24,0x1F,
0x08,0x16,0x09,0x14,0x2F,0x34,0x03,0x07,
0x0F,0x3D,0x3E,0x3B,0x37,0x39,0x28,0x3C,
0x15,0x32,0x04,0x05,0x30,0x06,0x0A,0x13,
0x02,0x36,0x1E,0x12,0x1B,0x20,0x33,0x2E,
};

int main (int narg,char** argv){
	char user_input [65];
	printf("Digite a senha para desbloquear o arquivo: \n");
	fgets(user_input,65,stdin);
	size_t input_size = strlen(user_input);
	if (strlen (user_input) != 64){
		printf("Senha de tamanho incorreto!");
		return 1; 
	}
	uint8_t temp_sbox[65];
	generate_sbox(temp_sbox,user_input);
	for (int i = 0;i < 64; i++){
		if ( obfuscated[i] != temp_sbox[i] ){
			printf("Senha incorreta!\n",i,obfuscated[i], temp_sbox[i]);
			return 1;
		}
	}
	printf("Parabéns! Você acertou a senha.");
	return 0;
}
